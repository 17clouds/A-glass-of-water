function PShowWaitMessage(e,t){null==t&&(t=!1),PCloseWaitMessage(e,t);var n=document.getElementById(e);n&&(null==window.ajaxMessages&&(window.ajaxMessages={}),window.ajaxMessages.wait||(window.ajaxMessages.wait="Wait..."),n.innerHTML=window.ajaxMessages.wait,t&&(n.style.display="inline"))}function PCloseWaitMessage(e,t){null==t&&(t=!1);var n=document.getElementById(e);n&&(n.innerHTML="",t&&(n.style.display="none"))}function JCPHttpRequest(){this.Action={},this.InitThread=function(){for(;;){var e="TID"+Math.floor(1e6*Math.random());if(!this.Action[e])break}return e},this.SetAction=function(e,t){this.Action[e]=t},this._Close=function(e,t){this.Action[e]&&(this.Action[e]=null)},this._OnDataReady=function(e,t){this.Action[e]&&this.Action[e](t)},this._CreateHttpObject=function(){var e=null;if(window.XMLHttpRequest)try{e=new XMLHttpRequest}catch(e){}else if(window.ActiveXObject){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}if(!e)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}return e},this._SetHandler=function(TID,httpRequest){var _this=this;function __handlerReadyStateChange(){if(4==httpRequest.readyState){for(var s=httpRequest.responseText,code=[],start;-1!=(start=s.indexOf("<script>"));){var end=s.indexOf("<\/script>",start);-1!=end?(code[code.length]=s.substr(start+8,end-start-8),s=s.substr(0,start)+s.substr(end+9)):s=s.substr(0,start)+s.substr(start+8)}for(var i in _this._OnDataReady(TID,s),code)""!=code[i]&&eval(code[i]);_this._Close(TID,httpRequest)}}httpRequest.onreadystatechange=__handlerReadyStateChange},this._MyEscape=function(e){return escape(e).replace(/\+/g,"%2B")},this._PrepareData=function(e,t){var n="";if(null!=e)for(var a in e){n.length>0&&(n+="&");var r=this._MyEscape(a);t&&(r=t+"["+r+"]"),"object"==typeof e[a]?n+=this._PrepareData(e[a],r):n+=r+"="+this._MyEscape(e[a])}return n},this.Send=function(e,t,n){if(null!=n)var a=this._PrepareData(n);a.length>0&&(-1==t.indexOf("?")?t+="?"+a:t+="&"+a);var r=this._CreateHttpObject();return!!r&&(r.open("GET",t,!0),this._SetHandler(e,r),r.send(""))},this.Post=function(e,t,n){var a="";null!=n&&(a=this._PrepareData(n));var r=this._CreateHttpObject();return!!r&&(r.open("POST",t,!0),this._SetHandler(e,r),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(a))},this.__migrateSetHandler=function(e,t,n){function a(){t.contentWindow.document&&0!=t.contentWindow.document.body.innerHTML.length&&null!=n&&n(t.contentWindow.document.body.innerHTML)}t.addEventListener?t.addEventListener("load",a,!1):t.attachEvent&&t.attachEvent("onload",a)},this.MigrateFormToAjax=function(e,t){if(e&&(!e.target||"AJAX"!=e.target.substring(0,5))){var n=document.createElement("INPUT");n.type="hidden",n.name="AJAX_CALL",n.value="Y",e.appendChild(n);var a="AJAX_"+Math.round(1e5*Math.random());if(document.getElementById("frameName"))var r=document.getElementById("frameName");else{if("IE"==currentBrowserDetected)r=document.createElement('<iframe name="'+a+'"></iframe>');else r=document.createElement("IFRAME");r.style.display="none",r.src="",r.id=a,r.name=a,document.body.appendChild(r)}e.target=a,this.__migrateSetHandler(e,r,t)}}}var CPHttpRequest=new JCPHttpRequest,currentBrowserDetected="";window.opera?currentBrowserDetected="Opera":navigator.userAgent&&(-1!=navigator.userAgent.indexOf("MSIE")?currentBrowserDetected="IE":-1!=navigator.userAgent.indexOf("Firefox")&&(currentBrowserDetected="Firefox"));